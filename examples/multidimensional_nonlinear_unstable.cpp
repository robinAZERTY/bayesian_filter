/*
This is just a copy of test/ekf/B_multi_dimensional_nonlinear_unstable, without unit tests
*/

#include <ekf.hpp>
#ifdef NATIVE
#include <iostream>
#define NAN std::nan("")
#define isnan(x) std::isnan(x)
#include <cmath>
#endif

template <typename T>
internal::tmp<Vector<T>> && f(const Vector<T> &x, const Vector<T> &u, const Vector<T> &c)
{
    auto *ret = internal::tmp<Vector<T>>::get(x.size()); // ask for a temporary variable of the same size as x
    T ct = cos(x[3]), st = sin(x[3]);
    (*ret)[0] = x[0] + ct * x[2]*c[0];
    (*ret)[1] = x[1] + st * x[2]*c[0];
    (*ret)[2] = x[2] + u[0]*c[0];
    (*ret)[3] = x[3] + u[1]*c[0];
    return internal::move(*ret); // return the temporary variable
}

// simple measurement function
template <typename T>
internal::tmp<Vector<T>> && h0(const Vector<T> &x, const Vector<T> &c)
{
    auto *ret = internal::tmp<Vector<T>>::get(1); // ask for a temporary variable of size 2
    (*ret)[0] = 100/((x[0]-c[1])*(x[0]-c[1])+(x[1]-c[2])*(x[1]-c[2]));
    return internal::move(*ret);
}

template <typename T>
internal::tmp<Vector<T>> && h1(const Vector<T> &x, const Vector<T> &c)
{
    auto *ret = internal::tmp<Vector<T>>::get(1); // ask for a temporary variable of size 2
    (*ret)[0] = 100/((x[0]-c[3])*(x[0]-c[3])+(x[1]-c[4])*(x[1]-c[4]));
    return internal::move(*ret);
}

Vector<double> Z0(1), Z1(1); // measurement
symMatrix<double> R0(1, 1), R1(1,1); // measurement noise

Ekf<4, 2, 4, 2, double> ekf(f); // 4 state, 2 command, 4 parameters, 2 mesurments functions


// <DATA_START>
float UU0[] = { 0.000000, -0.222597, 0.346482, 0.173801, 0.182486, 0.157172, -0.122334, -1.419238, 0.306893, -0.890607, 0.161586, -0.596576, -0.101775, 0.285352, -1.213746, 0.787642, 0.091873, -0.010241, -0.627989, 0.417413, -0.350121, -0.313978, 0.281832, -0.372522, -0.338815, -0.446051, 0.001795, 0.347121, -1.005691, 0.073255, -0.456523, -0.134542, -0.114191, 0.103624, -0.094646, 0.009110, -0.276758, -0.698061, 0.527024, 0.502811, 0.387733, -0.267678, -0.319105, 0.093362, -0.272772, -0.790960, -0.041173, -0.794962, -0.348074, -0.182356, -0.561175, -0.204335, 0.196219, 0.415117, -0.022267, -0.622744, -0.040835, -0.343536, -0.282595, -0.672114, -0.671105, 0.127408, -0.375416, 0.073686, -0.279245, 0.251604, -0.309491, 0.516315, 0.103726, 0.127653, 0.009818, -0.034355, 0.492561, -0.473621, 0.143231, -0.245343, -0.831842, 0.163118, -0.606380, 0.346089, 0.073962, -0.820902, -0.045118, 0.606898, -0.279891, -0.542389, 0.170853, 0.059938, -0.229780, -0.262871, 0.285858, -0.852866, 0.745702, -0.395313, -0.421634, -0.475810, -0.255851, 0.185818, -0.688836, -1.056650, -0.670821, -0.051383, 0.109107, -1.617393, -0.837118, -0.195837, -0.113708, -0.175743, 0.122305, -1.492328, -0.244855, -0.191401, -0.467737, -0.220734, -0.320080, 0.180928, 0.236270, -0.788841, 0.118494, -0.624134, -1.142757, -0.095581, -1.166289, 0.046802, -0.354052, 0.713706, -1.092816, -0.559659, 0.262984, -0.361628, -1.171352, -0.771576, -0.015238, 0.101324, 0.259693, -0.216342, -0.306283, 0.164746, -0.715320, 0.019763, 0.234336, 0.003265, -0.346163, -0.053899, -0.825549, -0.123608, -0.727531, -0.489506, 0.068770, 0.109646, 0.127425, -0.647514, -0.472087, -0.493915, 0.039876, -0.204129, -0.221737, 0.030145, -0.286999, -1.271300, -0.988159, -1.120989, -0.810459, -0.283546, 0.382589, -0.495936, -0.094151, -1.086402, -0.201210, -0.456239, 0.751933, -0.329162, 0.427365, -0.972160, 0.348881, 0.810359, -0.813455, -0.252381, -0.084934, -0.331681, -0.696397, -0.776218, -0.684055, -0.849110, -0.544734, -0.300574, -0.191872, -0.346638, -0.429037, -0.456184, -0.254663, 0.107920, -0.492603, -0.685894, -0.913434, -0.613422, -0.361996, 0.086369, -0.118279, 0.225386, -1.381499, -0.506926, -0.689390, -0.528776, -0.282516, -1.091887, -0.515175, -1.152424, 0.337794, -0.526292, -1.062904, -1.281581, -0.147761, -0.722425, -0.286946, -0.895648, -1.134381, -0.739780, -0.319474, -0.227750, -0.680538, -1.073092, -0.258035, -0.289230, -0.971525, -0.496983, -0.873386, -0.513602, -0.887243, -0.302114, -0.920720, -0.412740, -0.633200, -1.030694, -1.533781, -1.236390, -0.251898, 0.042200, -0.819845, -0.677756, -0.816124, -0.650972, -0.849414, -0.747924, 0.065576, 0.597460, -0.714566, -0.997393, -0.531491, -1.697317, -0.689347, 0.050944, -0.707092, -0.617315, -0.486338, -0.353332, -1.363920, -0.223718, 0.293729, -0.500219, -0.920966, -0.202442, -0.892761, -0.428507, -0.278525, -0.758708, -0.290160, -0.312753, -1.016029, -1.078748, -0.322341, -0.898938, -0.339189, -1.332117, -0.266320, -1.012486, -0.037737, -0.917780, -0.677372, -1.690085, -0.083045, -0.518699, -0.608333, -1.546011, -0.956255, -0.756220, -1.553910, -0.726124, -0.793242, -0.972268, -0.277035, -0.574547, -1.372108, -0.713808, -0.170625, -0.574165, -0.955790, -0.491266, -1.485617, -0.931436, -0.893725, -0.768008, -1.063229, 0.198116, -0.270023, -0.362046, -1.689403, -0.961710, 0.070189, -1.066887, -0.780208, -0.809115, -1.272666, -0.816576, -1.219432, -1.016972, -0.505333, -0.151789, -0.772467, -0.752567, -0.352686, -0.333849, 0.540098, -1.426221, -0.262217, -0.609022, -0.700439, -0.259145, -1.623941, -0.923459, -0.367493, -0.648778, -0.874449, -1.389103, -1.109608, -0.588833, 0.084542, -0.360138, -1.399114, -0.499608, -0.873616, -1.645034, -1.167872, -0.301461, -1.541298, -0.308666, -0.445584, -0.360152, -0.951369, -0.478095, -0.452568, -0.922155, -0.738796, -0.983411, -0.613009, 0.211978, -0.481543, -1.362398, -1.096417, -0.671477, -1.312135, -0.529405, -1.348599, -0.578114, -1.321151, -0.933087, -0.617783, -0.729477, -1.365966, -1.306913, -0.615685, -0.756320, -1.252172, -1.198600, -0.484301, -1.151340, -0.641702, -0.278932, -0.333328, -0.231868, -1.249568, -0.945380, -1.403330, -0.971204, -1.090602, -0.683685, -0.787059, -1.228231, -0.874682, -1.099915, -0.400577, -0.842742, -0.606559, -0.757469, -0.801855, -0.537358, -1.540947, -0.210846, -0.600805, -0.911763, 0.034456, -1.356873, -1.315407, -0.825859, -0.962036, -1.315920, -0.338840, -0.729884, -1.499140, -1.132061, -1.299774, -0.573638, -0.676941, -1.761917, -0.498463, -0.790385, -1.584848, -1.517446, -1.451586, -0.162285, -0.870267, -2.161176, -0.605883, -1.251498, -0.194367, -0.457172, -0.767777, -0.183006, -1.662985, -1.232770, -0.943652, -1.286268, -0.808043, -0.587920, -1.165314, -0.481754, -0.872542, -1.840802, -1.984039, -1.263882, -0.823068, -0.936759, -0.284687, -0.562398, -1.799686, -1.519589, -0.744494, -1.714847, -0.845184, -1.882528, -0.855728, -1.136291, -0.295228, -1.217165, -0.853876, -1.668106, -1.611227, -0.339498, -0.580114, -0.984167, -0.737172, -0.747343, -1.137203, -1.111031, -1.201105, -0.917042, -1.191277, -0.833835, -0.220849, -1.696127, -2.174353, 0.022855, -1.662515, -1.888259, -1.183766, -1.169658, -1.215353, -1.741667, -0.571679, -0.287990, -0.635040, -1.503430, -1.474712, -1.078179, -0.402228, -2.015547, -1.531417, -1.015534, -1.191519, -0.910802, -1.095831, -0.715150, -0.633071, -0.975428, -1.000194, -1.713329, -1.174916, -0.835914, -1.277498, -0.977012, -0.865449, -1.321598, -1.127543, -1.616507, -1.778747, -0.434317, -1.989444, -0.755752, -1.359032, -1.440297, -1.275688, -2.057032, -1.667780, -1.347190, 0.065844, -1.399525, -0.464908, -1.188175, -1.519726, -1.627709, -1.222995, -0.659827, -0.587232, -1.057584, -1.144119, -2.121366, -1.318569, -0.997413, -1.054712, -1.941243, -1.446495, -1.270374, -0.996878, -2.114387, -1.340651, -1.181168, -0.036138, -0.847747, -1.657355, -0.354561, -1.353084, -0.663480, -1.671279, -0.803836, -1.275420, -1.445733, -1.384207, -0.755241, -1.464283, -0.880183, -1.267097, -0.336040, -1.449728, -0.368049, -0.603942, -1.939902, -1.517320, -1.410123, -1.121154, -0.655978, -1.230044, -1.766718, -1.926181, -1.798024, -1.491249, 0.077853, -1.628779, -0.692413, -0.989258, -1.526693, -1.404796, -1.981709, -1.323593, -1.096502, -1.243538, -1.425702, -1.663400, -1.497027, -1.591901, -1.955659, -1.851348, -1.216969, -1.569489, -0.396795, -1.377140, -1.529278, -0.998977, -1.257964, -1.715205, -1.385325, -1.396537, -0.440272, -1.115920, -0.860034, -1.594591, -0.617804, -1.375912, -1.753920, -0.423377, 0.285397, -2.704910, -0.911224, -1.397242, -1.826950, -1.388081, -1.756927, -0.681797, -0.882315, -1.197057, -1.098688, -1.967433, -1.208446, -0.939920, -1.403886, -0.539142, -1.768925, -1.438889, -1.929388, -1.458666, -0.900067, -0.327829, -1.511709, -1.233420, -1.318058, -2.178961, -1.284547, -1.039899, -0.587784, -1.085426, -1.011476, -0.989711, -0.950889, -2.203822, -1.603929, -1.260912, -0.914576, -2.004550, -1.243527, -0.979322, -0.745627, -1.283381, -1.288096, -0.483762, -2.031367, -1.136354, -1.420102, -1.220603, -1.213007, -2.510534, -1.468842, -1.348687, -2.039461, -1.609383, -1.353667, -1.179434, -1.628235, -1.580935, -1.717538, -1.107209, -1.262851, -1.458479, -1.345600, -2.285348, -1.724804, -0.645550, -1.279640, -1.225006, -1.393149, -1.236091, -2.124627, -1.738961, -2.284825, -1.147329, -0.716790, -1.345555, -1.599316, -1.963889, -2.226860, -1.973352, -1.270663, -1.707375, -1.424640, -1.609311, -1.208361, -1.643782, -1.566911, -1.755546, -0.743026, -1.438453, -0.145289, -1.857569, -1.511019, -1.452989, -2.014122, -0.562429, -0.986857, -1.615355, -0.967808, -1.173068, -1.356473, -1.008642, -1.276104, -1.944979, -1.349311, -1.555746, -1.410113, -1.334488, -0.672206, -0.951746, -2.087006, -0.408313, -1.799202, -1.419361, -1.099472, -1.319490, -1.894525, -1.816705, -1.779666, -0.741266, -0.649177, -1.325267, -1.833778, -0.352783, -1.530176, -2.278234, -1.347746, -0.729952, -1.425884, -1.945370, -1.839828, -1.456822, -2.071761, -1.506595, -0.937312, -1.635060, -2.010257, -1.103450, -1.840134, -1.684429, -0.964271, -1.513227, -1.256456, -1.463773, -0.677850, -1.531713, -2.565408, -1.345409, -2.348350, -1.876844, -0.715579, -1.464639, -1.796399, -1.404403, -1.361153, -1.801282, -0.764667, -0.933812, -1.981093, -1.287395, -0.386781, -1.388988, -1.220991, -1.609786, -2.119265, -0.681867, -0.990634, -1.359129, -0.978996, -1.150835, -2.161480, -0.798807, -1.223022, -1.136246, -2.474874, -1.274116, -1.381993, -1.428609, -1.957048, -0.925258, -1.803861, -0.817298, -1.134432, -1.874338, -1.468640, -0.882838, -1.989337, -1.146548, -1.294592, -1.676759, -1.740174, -0.860236, -1.303480, -1.841539, -1.808387, -1.816110, -1.296764, -1.575450, -2.340524, -1.532948, -0.638297, -2.821896, -1.165567, -1.524801, -1.123554, -1.259758, -1.284286, -2.578405, -1.837038, -2.052592, -1.374924, -1.098258, -1.437852, -2.108163, -1.246291, -0.871820, -1.719688, -1.890490, -2.345279, -2.372683, -0.855941, -1.557054, -1.508049, -1.908167, -1.892218, -1.941566, -1.474033, -1.732784, -1.768972, -0.962655, -1.745910, -2.008727, -1.325138, -0.984824, -1.365947, -1.751689, -1.748071, -1.713985, -1.794162, -2.020956, -0.928806, -1.549963, -1.957084, -2.401479, -1.017013, -1.910904, -0.799995, -0.744662, -1.058920, -2.467437, -1.063874, -2.228632, -1.550016, -2.377839, -0.874882, -1.580743, -1.954432, -2.278558, -1.493747, -0.968619, -1.563558, -0.915650, -1.287648, -1.842933, -1.616702, -1.304097, -0.889005, -2.175453, -1.610298, -2.012707, -1.331895, -1.650232, -1.747372, -1.331926, -2.044729, -1.941554, -1.948591, -1.109914, -2.212372, -2.449302, -1.510339, -0.925405, -2.078313, -1.416773, -1.349986, -3.007504, -1.563274, -2.110306, -1.735484, -1.388875, -1.415792, -2.367748, -1.456392, -0.968817, -2.440652, -1.780930, -1.114028, -1.867027, -1.287049, -1.419781, -1.315560, -1.668908, -1.635527, -1.485789, -1.827943, -1.326969, -1.344764, -1.681241, -1.814850, -1.595719, -1.229754, -1.721965, -2.083394, -1.628131, -1.126186, -1.286493, -1.823211, -2.222961, -1.755050, -2.458175, -1.345252, -1.439774, -2.019163, -1.882687, -1.298559, -1.118936, -1.372458, -1.522404, -2.225570, -1.641717, -1.641697, -1.419158, -1.656843, -1.535281, -2.613681, -1.648704, -1.109441, -1.762761, -2.701517, -1.510014, -1.731560, -2.089738, -1.641788, -1.982194, -2.492371, -1.904861, -1.750883, -1.810074, -1.377386, -1.659608, -1.849930, -1.036843, -1.394924, -0.905912, -1.546971, -1.197999, -1.346697, -0.938839, -1.999906, -1.110702, -2.602145, -1.640599, -2.571191, -1.833342, -1.701701, -1.383402, -0.563076, -1.508646, -1.750123, -1.563353, -1.706150, -1.768142, -1.344110, -2.189643, -1.189798, -2.495349, -1.719969, -1.446122, -2.114626, -1.897788, -1.435484, -1.325155, -1.924986, -1.872161, -1.492453, -1.895998, -0.692626, -2.136626, -1.157479, -1.741068, -0.971712, -0.522135, -2.107121, -0.424978, -0.347895, -1.845332, -1.916013, -1.918455, -0.965792, -1.026323, -0.787681 };
float UU1[] = { 0.000000, -0.583402, -0.699688, -0.173843, 0.891033, 0.107371, 1.244890, 0.991982, -0.825793, 0.163417, 1.285744, -1.254026, 0.952729, 1.129305, 1.370486, 0.055348, -2.679191, 0.962831, 1.517265, -1.047253, 0.467618, 0.307080, 0.598133, 1.061339, 0.746071, 0.554743, 1.049085, 1.162264, 0.047933, 1.474123, -0.239738, 0.257973, -0.517181, 0.697015, 0.715281, -0.163273, 1.878686, 0.274222, 0.888433, 0.644102, 1.371501, -0.874979, -0.526139, 2.304816, 1.194368, 0.595062, -0.108383, 0.732041, 1.435881, 3.692499, -1.645891, 1.709890, -0.902222, 1.227106, -0.126084, 0.254707, 0.438719, 0.457363, -0.392830, -0.354510, 1.536500, -0.417270, -0.175429, -1.100084, 1.820217, 0.360544, -0.068546, 1.628731, 2.680496, 1.218743, 1.555972, -0.872532, 0.626917, 0.114843, -0.101775, -1.053402, 1.591683, -0.101944, 0.732243, -0.402768, -0.774449, -0.571802, 0.571584, 0.244468, 2.656230, 1.116112, 1.052765, -0.051841, -0.680020, -0.410147, 1.817053, 1.857807, 0.425823, 0.356293, 0.086057, 2.397270, 0.103344, 1.067447, 1.206132, 0.365183, 0.414946, 1.166652, 0.379744, 1.401035, 0.872739, 1.933397, -0.060871, 0.280093, 0.537911, 0.168363, 0.593780, 1.051506, -0.593355, -0.097568, 0.038257, 0.047110, 0.477088, -1.185456, 0.230767, -0.056152, 0.550997, 2.090147, 1.954725, 0.078679, -0.878352, 0.333713, 1.071433, 0.124394, 0.781573, -0.026441, -0.348559, 0.853617, 0.201655, 0.706087, -0.648288, 2.372934, 0.460565, 0.822724, -1.229297, 1.273670, -0.460519, 0.925668, 0.509785, -0.214550, -0.366810, -1.622286, -1.971161, 0.438482, 0.892273, 2.934397, 2.182124, 1.664722, 1.188208, 1.629479, 1.930552, 0.406710, 0.186515, 1.682977, -1.092008, 0.265058, 1.615212, 1.028132, -0.052366, 1.143304, -0.919215, 1.002398, -0.307838, -0.632046, 0.721274, 3.270874, -0.669114, 1.542281, 2.322902, 1.579148, 1.853003, 1.092351, 1.115246, 0.593606, -0.077217, 2.295897, -0.029579, 1.068283, -1.417520, 0.630208, 0.982906, -0.138241, -0.628716, 1.701038, -0.426704, 0.739379, 0.650271, 0.530103, 1.984392, 1.476578, -0.580061, 0.707125, 1.862627, 0.284485, 2.615559, 1.627918, 0.704857, 0.215856, 2.515188, 0.457036, 2.094123, 0.768067, 0.854474, 0.896000, 1.043066, 1.089897, -0.781405, -0.092591, 0.969659, 0.302974, -0.701361, 1.660737, 0.083521, 3.092460, 2.160613, 2.858347, 1.353596, 0.242854, 0.785632, -0.163510, 0.707335, 0.299836, 0.624200, -0.839481, 1.534561, 1.817130, 2.020334, 0.076705, 0.991664, 1.026044, -0.397087, 0.420878, 0.198210, -0.554843, 0.481307, 1.936231, 0.783952, 0.124002, 1.453531, 0.685368, 1.715437, 0.383155, 0.473292, 0.616389, -0.225901, 0.825233, 0.899167, -0.071854, 2.968841, 0.918612, 1.000120, 1.369741, -0.480870, 0.070395, 1.746823, 1.410132, 2.105718, -0.484749, 0.901826, 0.203447, 1.002673, 0.840311, 0.482769, 0.277297, 1.370333, 0.635338, 1.354761, 1.151543, -0.000060, 1.509694, 0.885001, 0.025272, 0.493346, 2.590844, 0.933695, 2.527025, -0.216076, 1.217313, 2.814223, 2.118585, 1.424004, 0.115376, 1.732495, 1.641538, 1.085512, -0.235708, 1.080316, 0.689800, 1.077377, 3.141146, -0.847107, 1.572695, -1.057983, 0.109925, 0.017460, 0.505060, -0.343553, 2.001790, 0.919398, 1.109831, 0.844491, -0.946362, 0.672319, 1.864868, 0.748310, 1.964740, 1.302615, 3.370131, 0.578923, 3.661410, -0.894383, 0.774069, 0.395407, 1.504938, 4.027275, 0.556170, 2.001971, 1.169435, -0.295485, 1.955604, 1.355214, 2.432271, -0.022840, 0.546953, 0.594245, 1.314434, 2.465904, -0.451937, 0.509062, 1.425427, 0.629274, -0.482836, 0.954610, 2.119951, 0.992245, 0.670657, 1.615932, -0.207953, 0.956597, 1.332643, -0.214906, 1.441780, -0.245952, 1.174583, 0.574644, -0.011689, -0.360704, 2.205621, 2.131026, 0.021110, 1.460642, 1.658844, -0.602939, 0.911370, 1.371219, 1.528969, 1.566046, 2.974589, 0.790590, 1.118205, 0.431972, 2.207319, 1.173769, 0.952116, 2.012577, 2.752785, 1.028863, 2.725539, 0.144692, 1.753602, 1.828871, 1.364889, -0.931113, 3.758187, 2.697442, 0.957983, 1.049390, 0.634102, 0.418297, -0.925393, -0.320126, 1.931617, 1.567196, 0.471511, 1.524360, 2.286023, 2.027262, 0.551586, -0.405075, 2.793776, 0.450203, 0.218097, -0.007462, 2.137780, 0.794840, 0.216358, 0.924847, 1.625183, 0.822297, 0.559899, 1.159321, 2.687779, 1.750953, 0.801684, 1.692533, 0.228251, 1.069453, 1.451255, 0.338636, -1.091775, 2.840364, 2.653546, 1.324027, -0.679567, -0.132380, 1.438198, 0.369129, -0.794370, 1.298417, 1.394121, 0.924531, -1.077396, 1.695946, 0.108082, 0.694138, 0.302734, -1.319306, -1.066344, 0.595880, 1.280371, -1.511294, 2.089435, 2.088356, 1.071632, -0.442093, 0.303500, 0.034314, 1.519494, 1.511211, 1.293165, 1.820715, 1.074132, -0.422015, 0.534732, 0.498490, -0.557089, 1.491516, 1.321235, 1.753137, 2.298163, 1.120890, -1.073939, 1.141398, 0.694931, 1.511522, -1.499710, 1.137955, 0.316443, 3.175754, -1.827074, 0.245217, 3.312410, 1.242449, 0.207508, -0.241286, 1.685993, 3.138344, 0.609082, 1.254803, -0.408650, 0.729166, 1.844523, 1.567388, 0.968563, 1.209699, 1.257365, 0.742944, 2.554531, 0.301544, 0.977200, 0.493220, 1.314510, 0.218458, 2.311090, 0.120427, 1.984431, 1.625637, -0.587659, -0.003896, 1.623579, 1.655074, -1.552081, 1.690139, -1.150166, -0.287986, 0.310709, 0.134858, -0.280701, 0.471894, 0.214994, 0.568600, 0.039516, -0.017594, 0.197849, 1.537701, 0.300952, 0.100916, 1.394534, -0.475295, 1.747003, 1.223381, 0.856804, 0.108481, -0.273634, 1.408541, 1.395503, 0.831401, 0.582251, 0.526547, 1.397252, 1.360042, 2.054553, 0.985212, 1.209374, -0.213807, 0.174520, 0.237525, 0.546273, 0.103602, 1.616790, 0.136992, 0.553749, -1.271740, 0.646766, -0.094766, -0.157206, 0.685831, 1.074606, 1.577196, -0.381084, 1.484640, 2.804549, 1.982289, 0.817223, -0.042804, 1.218690, 2.996732, 2.008841, 2.143641, 0.340152, -0.296882, 0.452562, 0.978792, -0.684758, 1.270638, -0.069880, 1.576632, -0.148898, 2.005443, 0.144316, 0.802523, 0.318911, 0.984708, 1.135731, 1.404452, 0.268396, 0.555068, -2.548532, 0.585904, -0.290848, 2.106777, -0.746851, 1.039166, -0.045696, -0.482058, -1.694999, 0.595907, -0.016735, 0.148037, 0.712984, 0.484337, -1.050621, 2.504245, 0.250194, 1.234157, 1.457527, -0.720892, -0.504335, 0.350101, 0.477163, 0.888390, -0.070013, 1.551112, 0.843119, -0.132433, 0.233323, 0.551472, -0.060533, -0.207198, -0.214368, -0.461950, -0.262492, 1.056671, 0.403350, 0.468045, 1.073964, 0.098117, -0.254653, 0.095786, -0.616158, 1.095156, 1.383077, -0.020331, -0.323456, -0.678623, 0.555398, 0.230934, -1.219593, 0.158125, -0.235359, 2.098934, -0.054403, -1.193185, -0.597058, 0.324971, 0.381155, 0.934748, 0.737868, 1.366001, 0.523094, 1.513781, -0.123276, 1.215350, -0.623253, 0.392126, 0.606846, 1.966420, 0.235919, 0.163787, -0.794429, -0.713331, 0.564979, 0.653051, 0.822882, 0.116279, -1.386322, 1.640558, 0.297030, -1.051709, 0.507056, 0.364931, -0.412020, 0.594616, 0.906924, -0.785175, -0.491247, 0.875606, 1.015339, 0.255703, -0.036176, 2.417671, -0.176588, -1.138009, 0.442194, 0.411448, 0.160869, 0.254505, 0.589817, -0.157517, -0.178229, -0.454084, 0.285172, 0.957893, 0.076647, -0.669756, 0.295677, -0.094746, 2.993021, -2.844059, -0.613592, -0.464596, -0.845439, 0.561861, 0.568399, 1.764831, -1.958341, -0.983284, -0.190171, 0.100972, 0.731145, 0.855332, 0.018074, -0.326523, 0.423535, 0.944731, 2.002176, -0.753883, -1.505943, -0.665213, 1.512650, 0.580069, -0.770480, 0.590205, 0.442716, -0.241003, 0.680759, -0.933360, -0.386662, 1.186508, -1.228836, 0.100602, -1.640047, 1.339573, 0.019472, -1.520047, -1.631039, 1.812948, -1.687974, -0.331623, -2.023686, -2.398286, -0.447234, -0.687830, -0.017946, -0.026685, 0.224701, -0.759396, -0.741304, -1.484193, -0.838038, -0.671464, -0.986566, -1.037743, -1.294079, 0.412935, 0.235000, 0.412656, 0.133541, -1.096631, -1.153616, 0.534603, 1.365110, -0.758281, -1.264489, 0.151324, -1.999214, -0.925133, -1.154169, 1.241718, -1.361435, 0.122140, -1.447033, -0.481351, -1.478534, 0.055926, 1.090021, -1.869797, -0.185140, -1.326919, 1.018177, 0.140520, 1.041346, 1.371723, -0.087606, -2.300030, -1.274239, -2.328537, -1.651324, 0.170082, -0.204602, -0.198764, -1.071231, 2.110936, -0.066912, 0.252979, 0.685779, 0.975419, -0.391143, -0.034494, -0.359282, 0.181651, -0.748913, -0.583899, -0.338443, 0.597996, -0.848262, 1.002247, -0.646238, -1.508886, -2.381794, 0.147249, -1.324881, -0.246009, -0.877450, 1.364966, -0.131013, -1.352201, -0.976088, -1.211941, -2.073760, -0.750144, -0.248178, -2.759165, -0.893840, -2.478616, 0.357491, -0.905584, 1.522494, -0.993888, -0.133753, -2.404209, 1.430274, -2.183167, -1.452179, -0.696338, -0.436585, -0.247420, -0.864844, 1.029817, 0.827640, -0.418298, 0.483457, -0.297818, 0.234839, -2.171235, 1.134476, -0.549370, 0.508060, -1.594102, 0.316413, -1.081382, -0.908262, -2.125136, 0.040931, -0.770776, -2.088356, -1.733561, -2.114392, -1.109858, -1.032382, -0.522943, -1.330756, -0.891658, -2.923928, -0.264357, -0.163003, -1.227771, -2.562174, -1.499300, -1.004034, -0.511290, 0.103493, -1.135871, -1.809612, -1.081933, -0.720319, -0.328060, -0.960546, -3.009810, 0.219705, -1.936782, 0.072042, -0.793347, 1.377077, -0.759184, -0.809519, -1.942771, -0.463073, -1.844471, 0.774243, -0.915872, -1.645709, -1.249685, -0.390057, -0.977898, -1.513862, -2.811865, -0.857231, -2.916365, -1.274798, -0.803692, -2.207631, -0.194512, -0.679830, 0.467152, -0.674745, -0.671562, -1.199025, 1.176115, -0.943846, 0.018432, -0.483706, -1.005357, -0.393368, -1.045014, -0.288692, -0.572968, 1.032971, -0.359129, -1.161118, 0.120903, -1.030958, 1.129842, -0.212887, -1.507078, -1.044531, -1.385190, -2.245054, -2.731037, -0.616542, -2.046254, -1.599595, -1.416568, -0.507885, -1.141645, -1.742903, -0.245569, -0.663161, -0.750945, -2.516933, 0.439608, -1.142867, 0.855939, -0.965015, -0.807639, -0.742470, -2.389342, 0.158610, -1.063922, -1.110068, -2.813740, -0.066716, -0.241326, -0.537738, -3.857953, 1.186082, -2.532653, -1.114643, -1.887146, -1.735315, -0.983484, -1.885863, -0.752173, -1.150531, -1.908602, -1.317346, 0.839710, -2.266347, -0.286707, -1.674244, -0.095949, -2.301587, -1.229865, -0.861406, -1.938250, -0.944330, -0.211028, -1.234400, 0.157822, 1.369510, -1.662912, -1.599733, -2.457000, -0.509980, -2.218103, 0.654038, 0.591760, -0.093569, 0.381311, 0.301074, -2.564483, -1.339536, -1.053585, -0.940906, -0.081168, -2.215655, 1.034274, 0.071288, 0.256331, -0.699629, -0.410340, -1.576541, -2.335013, -1.673417, -3.026708, 1.335920, -1.714688, -1.249508, -1.400132, 0.803401, -0.783686, -0.875903, -0.929089, -2.035667, 0.520716, -1.878739 };
float ZZ0[] = { NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.126816, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.133155, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.133403, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.162339, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.129815, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.130583, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.101038, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.046411, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.093832, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.107203, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.130471, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.129025, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.118063, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.144918, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.198298, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.233920, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.242094, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.311207, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.325763, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.377538, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.436167, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.545790, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.504655, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.587750, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.636984, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.602632, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.593078, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.502702, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.440510, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.366892, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.324876, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.408877, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.228591, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.202759, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.299260, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.249868, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.190804, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.193467, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.221116, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.186748, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.185291, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.165863, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.200726, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.142369, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.225866, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.167425, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.211409, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.206151, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN };
float ZZ1[] = { NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 1.080326, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 1.782270, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 2.663317, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 4.293454, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 5.858933, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 5.513318, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 3.728737, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 2.472573, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 1.662694, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 1.170486, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.951360, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.725793, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.540909, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.436047, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.444610, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.421405, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.306595, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.318221, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.411241, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.348013, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.417290, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.435285, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.504814, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.529801, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.509324, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.475616, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.609063, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.657095, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.602378, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.809505, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.761003, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.824323, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.811516, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.711063, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.757843, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.726641, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.767830, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.669372, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.570915, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.567217, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.599714, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.516739, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.543773, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.508818, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, 0.374788, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN, NAN };

void init_filter()
{
    R0(0, 0) = 0.002;
    R1(0, 0) = 0.001904761904761905;
    ekf.C[0] = 0.01;
    ekf.C[1] = 0.0;
    ekf.C[2] = 30.0;
    ekf.C[3] = 10.0;
    ekf.C[4] = 5.0;
    ekf.X[0] = 0.0;
    ekf.X[1] = 0.0;
    ekf.X[2] = 10.0;
    ekf.X[3] = 0.0;
    ekf.P(0, 0) = 0.0;
    ekf.P(0, 1) = 0.0;
    ekf.P(0, 2) = 0.0;
    ekf.P(0, 3) = 0.0;
    ekf.P(1, 0) = 0.0;
    ekf.P(1, 1) = 0.0;
    ekf.P(1, 2) = 0.0;
    ekf.P(1, 3) = 0.0;
    ekf.P(2, 0) = 0.0;
    ekf.P(2, 1) = 0.0;
    ekf.P(2, 2) = 0.0;
    ekf.P(2, 3) = 0.0;
    ekf.P(3, 0) = 0.0;
    ekf.P(3, 1) = 0.0;
    ekf.P(3, 2) = 0.0;
    ekf.P(3, 3) = 0.0;
    ekf.Cov_U(0, 0) = 0.25000000000000006;
    ekf.Cov_U(0, 1) = 0.0;
    ekf.Cov_U(1, 0) = 0.0;
    ekf.Cov_U(1, 1) = 1.0000000000000002;
    ekf.setMeasurementFunction(h0,1,0);
    ekf.setMeasurementFunction(h1,1,1);
}
// <DATA_END>



void setUp() {
    // Initialisation avant chaque test (laisser vide si inutile)
}

void tearDown() {
    // Nettoyage apr√®s chaque test (laisser vide si inutile)
}


void test_DATA()
{
    init_filter();
    for (int i = 1; i < sizeof(UU0)/sizeof(UU0[0]); i++)
    {
        ekf.U[0] = UU0[i];
        ekf.U[1] = UU1[i];
        ekf.predict();
        if (!isnan(ZZ0[i]))
        {
            Z0[0] = ZZ0[i];
            ekf.update(Z0, R0);
        }
        if (!isnan(ZZ1[i]))
        {
            Z1[0] = ZZ1[i];
            ekf.update(Z1, R1, 1);
        }
    }
}


void setup() {
    test_DATA();
}

void loop() {
}

#ifdef NATIVE
int main(int argc, char **argv) {
    setup();
}
#endif
